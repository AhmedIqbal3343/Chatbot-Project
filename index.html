<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot</title>
    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
    color: #f8fafc;
    height: 100vh;
    overflow: hidden;
}

.container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border-left: 1px solid rgba(255, 255, 255, 0.1);
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}

.header {
    padding: 20px 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(30, 30, 60, 0.7);
    backdrop-filter: blur(20px);
}

.header h1 {
    font-size: 24px;
    font-weight: 600;
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.status {
    margin-top: 8px;
    font-size: 14px;
    color: #4ecdc4;
    display: flex;
    align-items: center;
    gap: 8px;
}

.status-dot {
    width: 8px;
    height: 8px;
    background: #4ecdc4;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.chat-container {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
    scroll-behavior: smooth;
}

.message {
    margin-bottom: 24px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.message.user {
    display: flex;
    justify-content: flex-end;
}

.message.ai {
    display: flex;
    justify-content: flex-start;
}

.message-content {
    max-width: 80%;
    padding: 16px 20px;
    border-radius: 18px;
    font-size: 15px;
    line-height: 1.6;
    position: relative;
}

.message.user .message-content {
    background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);
    color: white;
    border-bottom-right-radius: 6px;
}

.message.ai .message-content {
    background: rgba(78, 205, 196, 0.15);
    border: 1px solid rgba(78, 205, 196, 0.3);
    color: #f8fafc;
    border-bottom-left-radius: 6px;
}

.message-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 14px;
    margin: 0 12px;
    flex-shrink: 0;
}

.message.user .message-avatar {
    background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);
    color: white;
    order: 2;
}

.message.ai .message-avatar {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.input-container {
    padding: 24px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(30, 30, 60, 0.7);
    backdrop-filter: blur(20px);
}

.input-wrapper {
    display: flex;
    gap: 12px;
    align-items: flex-end;
    max-width: 100%;
}

.input-field {
    flex: 1;
    padding: 16px 20px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 24px;
    background: rgba(255, 255, 255, 0.1);
    color: #f8fafc;
    font-size: 15px;
    font-family: inherit;
    resize: none;
    min-height: 52px;
    max-height: 120px;
    outline: none;
    transition: all 0.3s ease;
}

.input-field:focus {
    border-color: #ff6b6b;
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
}

.input-field::placeholder {
    color: rgba(248, 250, 252, 0.5);
}

.send-button {
    width: 52px;
    height: 52px;
    border: none;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.send-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
}

.send-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.typing-indicator {
    display: none;
    padding: 16px 20px;
    background: rgba(78, 205, 196, 0.15);
    border: 1px solid rgba(78, 205, 196, 0.3);
    border-radius: 18px;
    border-bottom-left-radius: 6px;
    max-width: 80px;
}

.typing-dots {
    display: flex;
    gap: 4px;
}

.typing-dots span {
    width: 8px;
    height: 8px;
    background: #4ecdc4;
    border-radius: 50%;
    animation: typing 1.4s infinite;
}

.typing-dots span:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-dots span:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typing {
    0%, 60%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
    }
    30% {
        opacity: 1;
        transform: scale(1);
    }
}

.welcome-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
    padding: 40px;
}

.welcome-icon {
    font-size: 64px;
    margin-bottom: 24px;
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.welcome-title {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 12px;
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.welcome-subtitle {
    font-size: 16px;
    color: rgba(248, 250, 252, 0.7);
    margin-bottom: 32px;
    max-width: 400px;
}

.sample-prompts {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    max-width: 600px;
    width: 100%;
}

.sample-prompt {
    padding: 16px 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.05);
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
}

.sample-prompt:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: #ff6b6b;
    transform: translateY(-2px);
}

.clear-button {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #ef4444;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}

.clear-button:hover {
    background: rgba(239, 68, 68, 0.2);
    border-color: #ef4444;
}

/* Scrollbar styling */
.chat-container::-webkit-scrollbar {
    width: 6px;
}

.chat-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.chat-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
}

.chat-container::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .container {
        border-left: none;
        border-right: none;
    }

    .header {
        padding: 16px 20px;
    }

    .header h1 {
        font-size: 20px;
    }

    .chat-container {
        padding: 16px 20px;
    }

    .input-container {
        padding: 16px 20px;
    }

    .message-content {
        max-width: 90%;
    }

    .welcome-title {
        font-size: 24px;
    }

    .sample-prompts {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                <div>
                    <h1>ü§ñ AI Assistant</h1>
                    <div class="status">
                        <div class="status-dot"></div>
                        <span id="statusText">Ready to help</span>
                    </div>
                </div>
                <button class="clear-button" onclick="clearChat()">Clear Chat</button>
            </div>
        </div>

        <div class="chat-container" id="chatContainer">
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-icon">ü§ñ</div>
                <div class="welcome-title">Welcome to AI Assistant</div>
                <div class="welcome-subtitle">
                    I'm here to help you with questions, creative tasks, and problem-solving. What would you like to explore today?
                </div>
                <div class="sample-prompts">
                    <div class="sample-prompt" onclick="sendSamplePrompt('Tell me a fun fact about space')">
                        <strong>üåå Fun Fact</strong><br>
                        Tell me a fun fact about space
                    </div>
                    <div class="sample-prompt" onclick="sendSamplePrompt('Help me write a professional email')">
                        <strong>‚úâÔ∏è Writing Help</strong><br>
                        Help me write a professional email
                    </div>
                    <div class="sample-prompt" onclick="sendSamplePrompt('Explain quantum computing simply')">
                        <strong>üî¨ Explain</strong><br>
                        Explain quantum computing simply
                    </div>
                    <div class="sample-prompt" onclick="sendSamplePrompt('Give me a creative writing prompt')">
                        <strong>‚ú® Creative</strong><br>
                        Give me a creative writing prompt
                    </div>
                </div>
            </div>

            <div class="message ai" style="display: none;">
                <div class="message-avatar">AI</div>
                <div class="message-content typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-container">
            <div class="input-wrapper">
                <textarea
                    class="input-field"
                    id="messageInput"
                    placeholder="Type your message here..."
                    rows="1"
                    onkeypress="handleKeyPress(event)"
                    oninput="adjustTextareaHeight(this)"
                ></textarea>
                <button class="send-button" id="sendButton" onclick="sendMessage()">
                    ‚û§
                </button>
            </div>
        </div>
    </div>

    <script>
    let chatHistory = [];
    let isGenerating = false;
    const API_BASE_URL = 'http://localhost:5000'; // Base URL for API

    function adjustTextareaHeight(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
    }

    function handleKeyPress(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            sendMessage();
        }
    }

    function sendSamplePrompt(prompt) {
        document.getElementById('messageInput').value = prompt;
        sendMessage();
    }

    async function sendMessage() {
        const input = document.getElementById('messageInput');
        const message = input.value.trim();

        if (!message || isGenerating) return;

        // Hide welcome screen
        document.getElementById('welcomeScreen').style.display = 'none';

        // Add user message
        addMessage(message, 'user');

        // Clear input
        input.value = '';
        input.style.height = 'auto';

        // Show typing indicator
        showTypingIndicator();

        isGenerating = true;
        updateStatus('Generating response...');
        document.getElementById('sendButton').disabled = true;

        try {
            // Call your Python backend
            const response = await callChatbotAPI(message);

            // Hide typing indicator and add AI response
            hideTypingIndicator();
            addMessage(response, 'ai');

        } catch (error) {
            hideTypingIndicator();
            addMessage('Error: Could not connect to the chatbot server. Make sure your Flask backend is running on port 5000.', 'ai');
            console.error('API Error:', error);
        } finally {
            isGenerating = false;
            updateStatus('Ready to help');
            document.getElementById('sendButton').disabled = false;
        }
    }

    // Actual API call to your Python backend
    async function callChatbotAPI(message) {
        const response = await fetch(`${API_BASE_URL}/api/chat`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                message: message
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        return data.response;
    }

    // Clear chat history on backend
    async function clearBackendChat() {
        try {
            await fetch(`${API_BASE_URL}/api/clear`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });
        } catch (error) {
            console.error('Error clearing backend chat:', error);
        }
    }

    function addMessage(content, type) {
        const chatContainer = document.getElementById('chatContainer');

        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${type}`;

        const avatar = document.createElement('div');
        avatar.className = 'message-avatar';
        avatar.textContent = type === 'user' ? 'You' : 'AI';

        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        messageContent.textContent = content;

        messageDiv.appendChild(avatar);
        messageDiv.appendChild(messageContent);

        // Add to chat container but before the typing indicator
        const typingIndicator = document.querySelector('.message.ai:last-child');
        chatContainer.insertBefore(messageDiv, typingIndicator);

        // Save to history
        chatHistory.push({ type, content });

        // Scroll to bottom
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function showTypingIndicator() {
        document.getElementById('typingIndicator').style.display = 'block';
        document.querySelector('#typingIndicator').parentElement.style.display = 'flex';

        const chatContainer = document.getElementById('chatContainer');
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function hideTypingIndicator() {
        document.getElementById('typingIndicator').style.display = 'none';
        document.querySelector('#typingIndicator').parentElement.style.display = 'none';
    }

    function updateStatus(status) {
        document.getElementById('statusText').textContent = status;
    }

    function clearChat() {
        if (confirm('Are you sure you want to clear the chat history?')) {
            const chatContainer = document.getElementById('chatContainer');
            // Remove all messages except the typing indicator
            const messages = chatContainer.querySelectorAll('.message:not(:last-child)');
            messages.forEach(msg => msg.remove());

            // Show welcome screen again
            document.getElementById('welcomeScreen').style.display = 'flex';

            // Clear history
            chatHistory = [];

            // Clear backend history too
            clearBackendChat();

            updateStatus('Ready to help');
        }
    }

    // Test backend connection on load
    async function testBackendConnection() {
        try {
            const response = await fetch(`${API_BASE_URL}/api/chat`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: "Test connection"
                })
            });

            if (response.ok) {
                updateStatus('Ready to help');
            } else {
                updateStatus('Backend not connected');
            }
        } catch (error) {
            updateStatus('Backend not connected');
            console.error('Connection test failed:', error);
        }
    }

    // Focus input on load and test connection
    window.addEventListener('load', () => {
        document.getElementById('messageInput').focus();
        testBackendConnection();
    });
</script>
</body>
</html>